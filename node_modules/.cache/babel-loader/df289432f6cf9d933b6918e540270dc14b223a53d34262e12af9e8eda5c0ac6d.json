{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useParams}from'react-router-dom';import formatDistanceToNow from'date-fns/formatDistanceToNow';import'../styles/ExperienceDetailsPage.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const getVibeNames=async vibeIds=>{try{const response=await fetch('/api/vibes/batch',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({vibeIds})});if(!response.ok){throw new Error('Network response was not ok');}const vibeNames=await response.json();return vibeNames||['Unknown Vibe'];}catch(error){console.error('Failed to fetch vibes:',error);return['Unknown Vibe'];}};const Modal=_ref=>{let{show,onClose,reviews}=_ref;if(!show){return null;}return/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Reviews\"}),/*#__PURE__*/_jsx(\"button\",{className:\"close-button\",onClick:onClose,children:\"X\"}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-content\",children:/*#__PURE__*/_jsx(\"ul\",{children:reviews.map((review,index)=>/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:review.reviewer}),\": \",review.text,\" (Rating: \",review.rating,\")\"]})},index))})})]})});};const ExperienceDetailsPage=()=>{const{id}=useParams();const[experience,setExperience]=useState(null);const[vibeNames,setVibeNames]=useState([]);const[showModal,setShowModal]=useState(false);useEffect(()=>{const fetchExperience=async()=>{try{const response=await fetch(\"/api/experiences/\".concat(id));if(!response.ok){throw new Error('Failed to fetch experience details');}const data=await response.json();setExperience(data);// Fetch vibe names\nif(data.vibes&&data.vibes.length>0){const names=await getVibeNames(data.vibes);setVibeNames(names);}}catch(error){console.error('Error fetching experience details:',error);}};fetchExperience();},[id]);const renderStars=rating=>{const fullStars=Math.floor(rating);const remainder=rating-fullStars;const hasHalfStar=remainder>=0.3&&remainder<0.8;const stars=[];for(let i=1;i<=fullStars;i++){stars.push(/*#__PURE__*/_jsx(\"span\",{className:\"star filled\"},i));}if(hasHalfStar){stars.push(/*#__PURE__*/_jsx(\"span\",{className:\"star half-filled\"},\"half\"));}const emptyStars=5-fullStars-(hasHalfStar?1:0);for(let i=0;i<emptyStars;i++){stars.push(/*#__PURE__*/_jsx(\"span\",{className:\"star\"},\"empty\".concat(i)));}return stars;};if(!experience){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"experience-detail-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"experience-info\",children:[/*#__PURE__*/_jsx(\"h1\",{children:experience.name}),/*#__PURE__*/_jsx(\"img\",{src:experience.pictureUrl,alt:experience.name,className:\"experience-image\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Location:\"}),\" \",experience.location]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Rating:\"}),\" \",renderStars(experience.rating)]}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Vibes:\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"vibes-container\",children:vibeNames.map((vibe,index)=>/*#__PURE__*/_jsx(\"span\",{className:\"vibe\",children:vibe},index))}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Created:\"}),\" \",formatDistanceToNow(new Date(experience.createdAt)),\" ago\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"reviews-button-container\",children:/*#__PURE__*/_jsx(\"button\",{className:\"reviews-button\",onClick:()=>setShowModal(true),children:\"View Reviews\"})})]})]}),/*#__PURE__*/_jsx(Modal,{show:showModal,onClose:()=>setShowModal(false),reviews:experience.reviews})]});};export default ExperienceDetailsPage;","map":{"version":3,"names":["React","useState","useEffect","useParams","formatDistanceToNow","jsx","_jsx","jsxs","_jsxs","getVibeNames","vibeIds","response","fetch","method","headers","body","JSON","stringify","ok","Error","vibeNames","json","error","console","Modal","_ref","show","onClose","reviews","className","children","onClick","map","review","index","reviewer","text","rating","ExperienceDetailsPage","id","experience","setExperience","setVibeNames","showModal","setShowModal","fetchExperience","concat","data","vibes","length","names","renderStars","fullStars","Math","floor","remainder","hasHalfStar","stars","i","push","emptyStars","name","src","pictureUrl","alt","location","vibe","Date","createdAt"],"sources":["/home/bradley/projects/TravelVibesPR/src/pages/ExperienceDetailsPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams } from 'react-router-dom';\nimport formatDistanceToNow from 'date-fns/formatDistanceToNow';\nimport '../styles/ExperienceDetailsPage.css';\n\nconst getVibeNames = async (vibeIds) => {\n    try {\n        const response = await fetch('/api/vibes/batch', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({ vibeIds }),\n        });\n        if (!response.ok) {\n            throw new Error('Network response was not ok');\n        }\n        const vibeNames = await response.json();\n        return vibeNames || ['Unknown Vibe'];\n    } catch (error) {\n        console.error('Failed to fetch vibes:', error);\n        return ['Unknown Vibe'];\n    }\n};\n\nconst Modal = ({ show, onClose, reviews }) => {\n    if (!show) {\n        return null;\n    }\n\n    return (\n        <div className=\"modal-overlay\">\n            <div className=\"modal\">\n                <h2>Reviews</h2>\n                <button className=\"close-button\" onClick={onClose}>X</button>\n                <div className=\"modal-content\">\n                    <ul>\n                        {reviews.map((review, index) => (\n                            <li key={index}>\n\n                                <p><strong>{review.reviewer}</strong>: {review.text} (Rating: {review.rating})</p>\n                            </li>\n                        ))}\n                    </ul>\n                </div>\n            </div>\n        </div>\n    );\n};\n\n\n\nconst ExperienceDetailsPage = () => {\n    const { id } = useParams();\n    const [experience, setExperience] = useState(null);\n    const [vibeNames, setVibeNames] = useState([]);\n    const [showModal, setShowModal] = useState(false);\n\n    useEffect(() => {\n        const fetchExperience = async () => {\n            try {\n                const response = await fetch(`/api/experiences/${id}`);\n                if (!response.ok) {\n                    throw new Error('Failed to fetch experience details');\n                }\n                const data = await response.json();\n                setExperience(data);\n\n                // Fetch vibe names\n                if (data.vibes && data.vibes.length > 0) {\n                    const names = await getVibeNames(data.vibes);\n                    setVibeNames(names);\n                }\n            } catch (error) {\n                console.error('Error fetching experience details:', error);\n            }\n        };\n\n        fetchExperience();\n    }, [id]);\n\n    const renderStars = (rating) => {\n        const fullStars = Math.floor(rating);\n        const remainder = rating - fullStars;\n        const hasHalfStar = remainder >= 0.3 && remainder < 0.8;\n        const stars = [];\n\n        for (let i = 1; i <= fullStars; i++) {\n            stars.push(\n                <span key={i} className=\"star filled\"></span>\n            );\n        }\n\n        if (hasHalfStar) {\n            stars.push(\n                <span key=\"half\" className=\"star half-filled\"></span>\n            );\n        }\n\n        const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);\n        for (let i = 0; i < emptyStars; i++) {\n            stars.push(\n                <span key={`empty${i}`} className=\"star\"></span>\n            );\n        }\n\n        return stars;\n    };\n\n\n\n\n    if (!experience) {\n        return <div>Loading...</div>;\n    }\n\n    return (\n        <div className=\"experience-detail-container\">\n            <div className=\"experience-info\">\n            <h1>{experience.name}</h1>\n                <img src={experience.pictureUrl} alt={experience.name} className=\"experience-image\" />\n                <div>\n                    <p><strong>Location:</strong> {experience.location}</p>\n                    <p><strong>Rating:</strong> {renderStars(experience.rating)}</p>\n                    <p><strong>Vibes:</strong></p>\n                    <div className=\"vibes-container\">\n                        {vibeNames.map((vibe, index) => (\n                            <span key={index} className=\"vibe\">{vibe}</span>\n                        ))}\n                    </div>\n                    <p><strong>Created:</strong> {formatDistanceToNow(new Date(experience.createdAt))} ago</p>\n                    <div className=\"reviews-button-container\">\n                        <button className=\"reviews-button\" onClick={() => setShowModal(true)}>View Reviews</button>\n                    </div>\n                </div>\n            </div>\n            <Modal show={showModal} onClose={() => setShowModal(false)} reviews={experience.reviews} />\n        </div>\n    );\n};\n\nexport default ExperienceDetailsPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}